import{d as Ee,f as g,a as i,s as b,b as De,c as se}from"../chunks/GQZyshw8.js";import{M as ye,Q as a,T as n,b as e,a2 as re,R as t,U as T,O as we,s as N,aD as fe,c as Ie,N as H,a3 as We,$ as qe,a7 as Pe}from"../chunks/3zZajnNw.js";import{i as h}from"../chunks/BgbN6ji0.js";import{h as Fe}from"../chunks/Cs8Plhgk.js";import{a as ze,e as pe,i as Re,s as Le,r as Ge}from"../chunks/R2Is90t-.js";import{a as He}from"../chunks/BV_Zy9yx.js";import{s as Qe,a as Ve}from"../chunks/ZadwNvFg.js";import{o as Ke}from"../chunks/Vf_yHKtD.js";import{p as Xe}from"../chunks/J5zZ0o5P.js";import{p as Ne}from"../chunks/DeVvsqkQ.js";import{w as Be}from"../chunks/BOm189kR.js";const Ye="";async function ae(U){try{const o=await fetch(`${Ye}${U}`);if(!o.ok){const W=await o.json();throw new Error(`${W.error}: ${W.message}`)}return await o.json()}catch(o){throw o instanceof Error?o:new Error(`API request failed: ${String(o)}`)}}const Ze={sessions:{async list(){return(await ae("/api/sessions")).sessions},async get(U){return(await ae(`/api/sessions/${U}`)).session},async getMessages(U){return(await ae(`/api/sessions/${U}/messages`)).messages}},projects:{async list(){return(await ae("/api/projects")).projects}},queues:{async list(){return(await ae("/api/queues")).queues},async get(U){return(await ae(`/api/queues/${U}`)).queue}}};var $e=g('<span class="language-label svelte-1e06m8e"> </span>'),et=De('<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),tt=De('<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>'),at=g('<div class="line-number svelte-1e06m8e"></div>'),st=g('<div class="code-lines svelte-1e06m8e"><div class="line-numbers svelte-1e06m8e"></div> <pre class="code-text svelte-1e06m8e"><code class="svelte-1e06m8e"> </code></pre></div>'),rt=g('<pre class="code-text svelte-1e06m8e"><code class="svelte-1e06m8e"> </code></pre>'),nt=g('<div class="code-block-container svelte-1e06m8e"><div class="code-header svelte-1e06m8e"><!> <button class="copy-button svelte-1e06m8e" aria-label="Copy code"><!></button></div> <div class="code-content svelte-1e06m8e"><!></div></div>');function je(U,o){ye(o,!0);let W=Ne(o,"showLineNumbers",3,!1),j=re(!1);async function Q(){try{await navigator.clipboard.writeText(o.code),N(j,!0),setTimeout(()=>{N(j,!1)},2e3)}catch(d){console.error("Failed to copy code:",d)}}let R=fe(()=>o.code.split(`
`));var r=nt(),O=a(r),B=a(O);{var y=d=>{var p=$e(),C=a(p,!0);t(p),T(()=>b(C,o.language)),i(d,p)};h(B,d=>{o.language&&d(y)})}var L=n(B,2);L.__click=Q;var F=a(L);{var A=d=>{var p=et();i(d,p)},c=d=>{var p=tt();i(d,p)};h(F,d=>{e(j)?d(A):d(c,!1)})}t(L),t(O);var k=n(O,2),w=a(k);{var u=d=>{var p=st(),C=a(p);pe(C,21,()=>e(R),Re,(V,K,X)=>{var s=at();s.textContent=X+1,i(V,s)}),t(C);var E=n(C,2),z=a(E),q=a(z,!0);t(z),t(E),t(p),T(()=>b(q,o.code)),i(d,p)},m=d=>{var p=rt(),C=a(p),E=a(C,!0);t(C),t(p),T(()=>b(E,o.code)),i(d,p)};h(w,d=>{W()?d(u):d(m,!1)})}t(k),t(r),T(()=>ze(L,"title",e(j)?"Copied!":"Copy code")),i(U,r),we()}Ee(["click"]);var ot=g('<div class="card p-8 text-center"><p class="text-gray-500 dark:text-gray-400">No messages yet</p></div>'),it=g('<div class="message-text svelte-5fg178"> </div>'),lt=g('<div class="message-text svelte-5fg178"> </div>'),dt=g('<div class="tool-section svelte-5fg178"><h4 class="tool-section-title svelte-5fg178"> </h4> <!></div>'),vt=g('<div class="tool-content svelte-5fg178"><div class="tool-section svelte-5fg178"><h4 class="tool-section-title svelte-5fg178">Input</h4> <!></div> <!></div>'),ct=g('<div class="tool-call svelte-5fg178"><button class="tool-header svelte-5fg178"><span class="tool-name svelte-5fg178"> </span> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div>'),ut=g('<div class="tool-calls svelte-5fg178"></div>'),gt=g('<div><div class="message-header svelte-5fg178"><span class="message-role svelte-5fg178"> </span> <span class="message-timestamp svelte-5fg178"> </span></div> <div class="message-content svelte-5fg178"><!></div> <!></div>'),pt=g('<div class="messages svelte-5fg178"></div>'),ft=g('<div class="message-timeline"><!></div>');function xt(U,o){ye(o,!0),Ne(o,"showThinking",3,!1);function W(c){return new Date(c).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function j(c){switch(c){case"user":return"message-user";case"assistant":return"message-assistant";case"system":return"message-system";default:return""}}function Q(c){return c.includes("```")}function R(c){const k=[],w=/```(\w+)?\n([\s\S]*?)```/g;let u=0,m;for(;(m=w.exec(c))!==null;){m.index>u&&k.push({type:"text",content:c.slice(u,m.index)});const d=m[1],p=m[2];p!==void 0&&k.push({type:"code",content:p,language:d}),u=m.index+m[0].length}return u<c.length&&k.push({type:"text",content:c.slice(u)}),k.length>0?k:[{type:"text",content:c}]}let r=re(Ie(new Set));function O(c){const k=new Set(e(r));k.has(c)?k.delete(c):k.add(c),N(r,k,!0)}function B(c){return JSON.stringify(c,null,2)}var y=ft(),L=a(y);{var F=c=>{var k=ot();i(c,k)},A=c=>{var k=pt();pe(k,21,()=>o.messages,w=>w.id,(w,u)=>{var m=gt(),d=a(m),p=a(d),C=a(p,!0);t(p);var E=n(p,2),z=a(E,!0);t(E),t(d);var q=n(d,2),V=a(q);{var K=v=>{var l=se(),f=H(l);pe(f,17,()=>R(e(u).content),Re,(_,S)=>{var M=se(),Y=H(M);{var Z=D=>{je(D,{get code(){return e(S).content},get language(){return e(S).language}})},$=D=>{var G=it(),J=a(G,!0);t(G),T(()=>b(J,e(S).content)),i(D,G)};h(Y,D=>{e(S).type==="code"?D(Z):D($,!1)})}i(_,M)}),i(v,l)},X=v=>{var l=lt(),f=a(l,!0);t(l),T(()=>b(f,e(u).content)),i(v,l)};h(V,v=>{Q(e(u).content)?v(K):v(X,!1)})}t(q);var s=n(q,2);{var x=v=>{var l=ut();pe(l,21,()=>e(u).toolCalls,f=>f.id,(f,_)=>{var S=ct(),M=a(S);M.__click=()=>O(e(_).id);var Y=a(M),Z=a(Y,!0);t(Y);var $=n(Y,2);t(M);var D=n(M,2);{var G=J=>{var ee=vt(),ne=a(ee),oe=n(a(ne),2);{let P=fe(()=>B(e(_).input));je(oe,{get code(){return e(P)},language:"json"})}t(ne);var xe=n(ne,2);{var Ue=P=>{var ie=se(),Ce=H(ie);pe(Ce,17,()=>e(u).toolResults,Re,(le,te)=>{var _e=se(),de=H(_e);{var me=ve=>{var ce=dt(),ue=a(ce),ke=a(ue,!0);t(ue);var Se=n(ue,2);{let be=fe(()=>e(te).isError?"error":void 0);je(Se,{get code(){return e(te).output},get language(){return e(be)}})}t(ce),T(()=>b(ke,e(te).isError?"Error":"Output")),i(ve,ce)};h(de,ve=>{e(te).id===e(_).id&&ve(me)})}i(le,_e)}),i(P,ie)};h(xe,P=>{e(u).toolResults&&P(Ue)})}t(ee),i(J,ee)};h(D,J=>{e(r).has(e(_).id)&&J(G)})}t(S),T(J=>{b(Z,e(_).name),Le($,0,`tool-icon ${J??""}`,"svelte-5fg178")},[()=>e(r).has(e(_).id)?"expanded":""]),i(f,S)}),t(l),i(v,l)};h(s,v=>{e(u).toolCalls&&e(u).toolCalls.length>0&&v(x)})}t(m),T((v,l)=>{Le(m,1,`message ${v??""}`,"svelte-5fg178"),b(C,e(u).role),b(z,l)},[()=>j(e(u).role),()=>W(e(u).timestamp)]),i(w,m)}),t(k),i(c,k)};h(L,c=>{o.messages.length===0?c(F):c(A,!1)})}t(y),i(U,y),we()}Ee(["click"]);var _t=g('<div class="cost-item svelte-1ox9e2p"><span class="cost-label svelte-1ox9e2p">Cache Read</span> <span class="cost-value svelte-1ox9e2p"> </span></div>'),mt=g('<div class="cost-item svelte-1ox9e2p"><span class="cost-label svelte-1ox9e2p">Cache Write</span> <span class="cost-value svelte-1ox9e2p"> </span></div>'),kt=g('<div class="cost-item svelte-1ox9e2p"><span class="cost-label svelte-1ox9e2p">Input Tokens</span> <span class="cost-value svelte-1ox9e2p"> </span></div> <div class="cost-item svelte-1ox9e2p"><span class="cost-label svelte-1ox9e2p">Output Tokens</span> <span class="cost-value svelte-1ox9e2p"> </span></div> <!> <!> <div class="cost-item total svelte-1ox9e2p"><span class="cost-label svelte-1ox9e2p">Total Tokens</span> <span class="cost-value svelte-1ox9e2p"> </span></div>',1),bt=g('<div class="cost-item total svelte-1ox9e2p"><span class="cost-label svelte-1ox9e2p">Total Cost</span> <span class="cost-value cost-highlight svelte-1ox9e2p"> </span></div>'),ht=g('<div class="cost-grid svelte-1ox9e2p"><!> <!></div>'),yt=g('<p class="text-sm text-gray-500 dark:text-gray-400">No cost information available</p>'),wt=g('<div class="card p-4"><!></div>');function Ut(U,o){ye(o,!0);function W(y){return`$${y.toFixed(4)}`}function j(y){return y.toLocaleString()}let Q=fe(()=>o.tokenUsage===void 0?0:o.tokenUsage.input+o.tokenUsage.output);var R=wt(),r=a(R);{var O=y=>{var L=ht(),F=a(L);{var A=w=>{var u=kt(),m=H(u),d=n(a(m),2),p=a(d,!0);t(d),t(m);var C=n(m,2),E=n(a(C),2),z=a(E,!0);t(E),t(C);var q=n(C,2);{var V=l=>{var f=_t(),_=n(a(f),2),S=a(_,!0);t(_),t(f),T(M=>b(S,M),[()=>j(o.tokenUsage.cacheRead)]),i(l,f)};h(q,l=>{o.tokenUsage.cacheRead!==void 0&&o.tokenUsage.cacheRead>0&&l(V)})}var K=n(q,2);{var X=l=>{var f=mt(),_=n(a(f),2),S=a(_,!0);t(_),t(f),T(M=>b(S,M),[()=>j(o.tokenUsage.cacheWrite)]),i(l,f)};h(K,l=>{o.tokenUsage.cacheWrite!==void 0&&o.tokenUsage.cacheWrite>0&&l(X)})}var s=n(K,2),x=n(a(s),2),v=a(x,!0);t(x),t(s),T((l,f,_)=>{b(p,l),b(z,f),b(v,_)},[()=>j(o.tokenUsage.input),()=>j(o.tokenUsage.output),()=>j(e(Q))]),i(w,u)};h(F,w=>{o.tokenUsage&&w(A)})}var c=n(F,2);{var k=w=>{var u=bt(),m=n(a(u),2),d=a(m,!0);t(m),t(u),T(p=>b(d,p),[()=>W(o.costUsd)]),i(w,u)};h(c,w=>{o.costUsd!==void 0&&w(k)})}t(L),i(y,L)},B=y=>{var L=yt();i(y,L)};h(r,y=>{o.tokenUsage||o.costUsd!==void 0?y(O):y(B,!1)})}t(R),i(U,R),we()}var Ct=g('<p class="text-sm text-gray-500 dark:text-gray-400 mt-1"> </p>'),St=g('<button class="btn btn-secondary" aria-label="Export as JSON">Export JSON</button> <button class="btn btn-secondary" aria-label="Export as Markdown">Export MD</button>',1),Tt=g('<div class="card p-6 border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20"><p class="text-red-800 dark:text-red-200"><strong>Error:</strong> </p> <button class="mt-4 btn btn-primary">Retry</button></div>'),jt=g('<div class="card p-6"><p class="text-gray-500 dark:text-gray-400 text-center">Loading session...</p></div>'),Rt=g('<div><span class="text-xs font-medium text-gray-600 dark:text-gray-400 uppercase block mb-1">Tasks</span> <p class="text-sm text-gray-900 dark:text-gray-100"> </p></div>'),Lt=g('<div class="space-y-6"><div class="card p-6"><h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Session Information</h2> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"><div><span class="text-xs font-medium text-gray-600 dark:text-gray-400 uppercase block mb-1">Status</span> <span> </span></div> <div><span class="text-xs font-medium text-gray-600 dark:text-gray-400 uppercase block mb-1">Project</span> <p class="text-sm text-gray-900 dark:text-gray-100 break-all"> </p></div> <div><span class="text-xs font-medium text-gray-600 dark:text-gray-400 uppercase block mb-1">Created</span> <p class="text-sm text-gray-900 dark:text-gray-100"> </p></div> <div><span class="text-xs font-medium text-gray-600 dark:text-gray-400 uppercase block mb-1">Updated</span> <p class="text-sm text-gray-900 dark:text-gray-100"> </p></div> <div><span class="text-xs font-medium text-gray-600 dark:text-gray-400 uppercase block mb-1">Messages</span> <p class="text-sm text-gray-900 dark:text-gray-100"> </p></div> <!></div></div> <!> <div><div class="flex justify-between items-center mb-4"><h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Messages</h2> <label class="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"><input type="checkbox" class="rounded border-gray-300 dark:border-gray-600"/> Show thinking</label></div> <!></div></div>'),Et=g('<div class="space-y-6"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Session Detail</h1> <!></div> <div class="flex gap-2"><button class="btn btn-secondary" aria-label="Go back">Back</button> <!></div></div> <!></div>');function Ft(U,o){ye(o,!0);const W=()=>Ve(Xe,"$page",j),[j,Q]=Qe(),R=fe(()=>W().params.id);let r=re(null),O=re(!0),B=re(null),y=re(!1);async function L(){if(e(R)===void 0){N(B,"No session ID provided"),N(O,!1);return}try{N(O,!0),N(B,null);const s=await Ze.sessions.get(e(R));N(r,s,!0),Be.subscribe(e(R))}catch(s){const x=s instanceof Error?s.message:String(s);N(B,x,!0),console.error("Error fetching session:",x),N(r,null)}finally{N(O,!1)}}function F(s){switch(s){case"active":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"paused":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"pending":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}}function A(s){return new Date(s).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function c(){if(e(r)===null)return;const s=JSON.stringify(e(r),null,2),x=new Blob([s],{type:"application/json"}),v=URL.createObjectURL(x),l=document.createElement("a");l.href=v,l.download=`session-${e(r).id}.json`,l.click(),URL.revokeObjectURL(v)}function k(){if(e(r)===null)return;let s=`# Session ${e(r).id}

`;s+=`**Project**: ${e(r).projectPath}
`,s+=`**Status**: ${e(r).status}
`,s+=`**Created**: ${A(e(r).createdAt)}
`,s+=`**Updated**: ${A(e(r).updatedAt)}

`,e(r).tokenUsage!==void 0&&(s+=`## Token Usage

`,s+=`- Input: ${e(r).tokenUsage.input.toLocaleString()}
`,s+=`- Output: ${e(r).tokenUsage.output.toLocaleString()}
`,e(r).tokenUsage.cacheRead!==void 0&&(s+=`- Cache Read: ${e(r).tokenUsage.cacheRead.toLocaleString()}
`),e(r).tokenUsage.cacheWrite!==void 0&&(s+=`- Cache Write: ${e(r).tokenUsage.cacheWrite.toLocaleString()}
`),s+=`
`),e(r).costUsd!==void 0&&(s+=`**Total Cost**: $${e(r).costUsd.toFixed(4)}

`),s+=`## Messages

`;for(const f of e(r).messages){if(s+=`### ${f.role.toUpperCase()} - ${A(f.timestamp)}

`,s+=`${f.content}

`,f.toolCalls!==void 0&&f.toolCalls.length>0){s+=`**Tool Calls**:

`;for(const _ of f.toolCalls)s+=`- **${_.name}**
`,s+="  ```json\n",s+=`  ${JSON.stringify(_.input,null,2)}
`,s+="  ```\n\n"}s+=`---

`}const x=new Blob([s],{type:"text/markdown"}),v=URL.createObjectURL(x),l=document.createElement("a");l.href=v,l.download=`session-${e(r).id}.md`,l.click(),URL.revokeObjectURL(v)}Ke(()=>{e(R)!==void 0&&Be.unsubscribe(e(R))});var w=Et();Fe("y7akim",s=>{We(()=>{qe.title=`Session ${e(R)??""} - Claude Code Agent`})});var u=a(w),m=a(u),d=n(a(m),2);{var p=s=>{var x=Ct(),v=a(x);t(x),T(()=>b(v,`ID: ${e(r).id??""}`)),i(s,x)};h(d,s=>{e(r)&&s(p)})}t(m);var C=n(m,2),E=a(C);E.__click=()=>window.history.back();var z=n(E,2);{var q=s=>{var x=St(),v=H(x);v.__click=c;var l=n(v,2);l.__click=k,i(s,x)};h(z,s=>{e(r)&&s(q)})}t(C),t(u);var V=n(u,2);{var K=s=>{var x=Tt(),v=a(x),l=n(a(v));t(v);var f=n(v,2);f.__click=()=>L(),t(x),T(()=>b(l,` ${e(B)??""}`)),i(s,x)},X=s=>{var x=se(),v=H(x);{var l=_=>{var S=jt();i(_,S)},f=_=>{var S=se(),M=H(S);{var Y=Z=>{var $=Lt(),D=a($),G=n(a(D),2),J=a(G),ee=n(a(J),2),ne=a(ee,!0);t(ee),t(J);var oe=n(J,2),xe=n(a(oe),2),Ue=a(xe,!0);t(xe),t(oe);var P=n(oe,2),ie=n(a(P),2),Ce=a(ie,!0);t(ie),t(P);var le=n(P,2),te=n(a(le),2),_e=a(te,!0);t(te),t(le);var de=n(le,2),me=n(a(de),2),ve=a(me,!0);t(me),t(de);var ce=n(de,2);{var ue=I=>{var ge=Rt(),he=n(a(ge),2),Je=a(he,!0);t(he),t(ge),T(()=>b(Je,e(r).tasks.length)),i(I,ge)};h(ce,I=>{e(r).tasks.length>0&&I(ue)})}t(G),t(D);var ke=n(D,2);{var Se=I=>{Ut(I,{get tokenUsage(){return e(r).tokenUsage},get costUsd(){return e(r).costUsd}})};h(ke,I=>{(e(r).tokenUsage||e(r).costUsd!==void 0)&&I(Se)})}var be=n(ke,2),Te=a(be),Me=n(a(Te),2),Oe=a(Me);Ge(Oe),Pe(),t(Me),t(Te);var Ae=n(Te,2);xt(Ae,{get messages(){return e(r).messages},get showThinking(){return e(y)}}),t(be),t($),T((I,ge,he)=>{Le(ee,1,`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${I??""}`),b(ne,e(r).status),b(Ue,e(r).projectPath),b(Ce,ge),b(_e,he),b(ve,e(r).messages.length)},[()=>F(e(r).status),()=>A(e(r).createdAt),()=>A(e(r).updatedAt)]),He(Oe,()=>e(y),I=>N(y,I)),i(Z,$)};h(M,Z=>{e(r)&&Z(Y)},!0)}i(_,S)};h(v,_=>{e(O)&&e(r)===null?_(l):_(f,!1)},!0)}i(s,x)};h(V,s=>{e(B)?s(K):s(X,!1)})}t(w),i(U,w),we(),Q()}Ee(["click"]);export{Ft as component};
