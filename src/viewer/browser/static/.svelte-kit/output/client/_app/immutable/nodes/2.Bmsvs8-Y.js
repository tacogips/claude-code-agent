import{d as ve,f as w,s as _,a as y,c as Ue}from"../chunks/GQZyshw8.js";import{n as qe,q as ee,V as fe,w as Me,aj as Ee,aB as Be,aC as Ie,x as Ne,M as ge,Q as r,R as a,T as v,U as L,b as e,aD as te,a2 as P,O as _e,s as k,c as Re,$ as Fe,N as Oe}from"../chunks/3zZajnNw.js";import{i as N}from"../chunks/BgbN6ji0.js";import{h as Qe}from"../chunks/Cs8Plhgk.js";import{o as Ve}from"../chunks/Vf_yHKtD.js";import{r as We,e as ue,i as Ye,s as V,a as ze}from"../chunks/R2Is90t-.js";import{b as Ge}from"../chunks/BV_Zy9yx.js";function xe(s,c,x=!1){if(s.multiple){if(c==null)return;if(!Ee(c))return Be();for(var l of s.options)l.selected=c.includes(R(l));return}for(l of s.options){var i=R(l);if(Ie(i,c)){l.selected=!0;return}}(!x||c!==void 0)&&(s.selectedIndex=-1)}function He(s){var c=new MutationObserver(()=>{xe(s,s.__value)});c.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ne(()=>{c.disconnect()})}function Je(s,c,x=c){var l=new WeakSet,i=!0;qe(s,"change",f=>{var D=f?"[selected]":":checked",m;if(s.multiple)m=[].map.call(s.querySelectorAll(D),R);else{var b=s.querySelector(D)??s.querySelector("option:not([disabled])");m=b&&R(b)}x(m),ee!==null&&l.add(ee)}),fe(()=>{var f=c();if(s===document.activeElement){var D=Me??ee;if(l.has(D))return}if(xe(s,f,i),i&&f===void 0){var m=s.querySelector(":checked");m!==null&&(f=R(m),x(f))}s.__value=f,i=!1}),He(s)}function R(s){return"__value"in s?s.__value:s.value}var Ke=w("<option> </option>"),Xe=w('<div class="card p-6"><p class="text-gray-500 dark:text-gray-400 text-center"> </p></div>'),Ze=w('<div class="flex items-center gap-1"><span class="text-gray-500 dark:text-gray-400">Cost:</span> <span class="font-medium text-gray-900 dark:text-gray-100"> </span></div>'),et=w('<div class="flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400"><span> </span></div>'),tt=w('<button class="card w-full p-4 hover:shadow-md transition-shadow text-left cursor-pointer"><div class="flex flex-col sm:flex-row justify-between gap-3"><div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-2"><span> </span> <span class="text-xs text-gray-500 dark:text-gray-400"> </span></div> <p class="text-sm font-medium text-gray-900 dark:text-gray-100 truncate"> </p> <p class="text-xs text-gray-500 dark:text-gray-400 truncate mt-1"> </p></div> <div class="flex sm:flex-col sm:items-end gap-4 sm:gap-2 text-sm"><div class="flex items-center gap-1"><span class="text-gray-500 dark:text-gray-400">Messages:</span> <span class="font-medium text-gray-900 dark:text-gray-100"> </span></div> <!> <!></div></div></button>'),at=w('<div class="space-y-3"></div>'),rt=w('<div class="space-y-4"><div class="flex flex-col sm:flex-row gap-4"><div class="flex-1"><input type="search" placeholder="Search by project path or session ID..." class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500"/></div> <div><select class="px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500"><option>All Projects</option><!></select></div> <div class="flex gap-2"><button> </button> <button> </button> <button> </button></div></div> <div class="text-sm text-gray-600 dark:text-gray-400"> </div> <!></div>');function st(s,c){ge(c,!0);let x=P(""),l=P("all"),i=P("date"),f=P("desc"),D=te(()=>{const t=new Set(c.sessions.map(n=>n.projectPath));return Array.from(t).sort()}),m=te(()=>c.sessions.filter(t=>{if(e(l)!=="all"&&t.projectPath!==e(l))return!1;if(e(x).trim()!==""){const n=e(x).toLowerCase(),u=t.projectPath.toLowerCase(),o=t.id.toLowerCase();return u.includes(n)||o.includes(n)}return!0})),b=te(()=>{const t=[...e(m)];return t.sort((n,u)=>{let o=0;if(e(i)==="date")o=new Date(n.createdAt).getTime()-new Date(u.createdAt).getTime();else if(e(i)==="cost"){const p=n.costUsd??0,U=u.costUsd??0;o=p-U}else e(i)==="messages"&&(o=n.messageCount-u.messageCount);return e(f)==="asc"?o:-o}),t});function $(t){switch(t){case"active":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"paused":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"pending":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}}function W(t){const n=new Date(t),o=new Date().getTime()-n.getTime(),p=Math.floor(o/(1e3*60*60*24));return p===0?`Today at ${n.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}`:p===1?"Yesterday":p<7?`${p} days ago`:n.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function Y(t){return t===void 0?"N/A":`$${t.toFixed(2)}`}function z(t){const n=t.split("/");return n.length>3?`.../${n.slice(-2).join("/")}`:t}function q(t){e(i)===t?k(f,e(f)==="asc"?"desc":"asc",!0):(k(i,t,!0),k(f,"desc"))}var d=rt(),g=r(d),S=r(g),T=r(S);We(T),a(S);var A=v(S,2),h=r(A),M=r(h);M.value=M.__value="all";var pe=v(M);ue(pe,17,()=>e(D),Ye,(t,n)=>{var u=Ke(),o=r(u,!0);a(u);var p={};L(U=>{_(o,U),p!==(p=e(n))&&(u.value=(u.__value=e(n))??"")},[()=>z(e(n))]),y(t,u)}),a(h),a(A);var ae=v(A,2),E=r(ae);E.__click=()=>q("date");let re;var me=r(E);a(E);var B=v(E,2);B.__click=()=>q("cost");let se;var ye=r(B);a(B);var F=v(B,2);F.__click=()=>q("messages");let ne;var be=r(F);a(F),a(ae),a(g);var G=v(g,2),he=r(G);a(G);var ke=v(G,2);{var we=t=>{var n=Xe(),u=r(n),o=r(u,!0);a(u),a(n),L(()=>_(o,e(x)||e(l)!=="all"?"No sessions match your filters.":"No sessions found. Start a Claude Code session to see it here.")),y(t,n)},Se=t=>{var n=at();ue(n,21,()=>e(b),u=>u.id,(u,o)=>{var p=tt();p.__click=()=>c.onSelect(e(o).id);var U=r(p),H=r(U),J=r(H),O=r(J),Ce=r(O,!0);a(O);var oe=v(O,2),je=r(oe,!0);a(oe),a(J);var Q=v(J,2),De=r(Q,!0);a(Q);var ie=v(Q,2),Le=r(ie);a(ie),a(H);var de=v(H,2),K=r(de),le=v(r(K),2),Ae=r(le,!0);a(le),a(K);var ce=v(K,2);{var Pe=C=>{var j=Ze(),I=v(r(j),2),X=r(I,!0);a(I),a(j),L(Z=>_(X,Z),[()=>Y(e(o).costUsd)]),y(C,j)};N(ce,C=>{e(o).costUsd!==void 0&&C(Pe)})}var $e=v(ce,2);{var Te=C=>{var j=et(),I=r(j),X=r(I);a(I),a(j),L(Z=>_(X,`${Z??""} tokens`),[()=>(e(o).tokenUsage.input+e(o).tokenUsage.output).toLocaleString()]),y(C,j)};N($e,C=>{e(o).tokenUsage&&C(Te)})}a(de),a(U),a(p),L((C,j)=>{V(O,1,`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${C??""}`,"svelte-1h8243g"),_(Ce,e(o).status),_(je,j),ze(Q,"title",e(o).projectPath),_(De,e(o).projectPath),_(Le,`ID: ${e(o).id??""}`),_(Ae,e(o).messageCount)},[()=>$(e(o).status),()=>W(e(o).createdAt)]),y(u,p)}),a(n),y(t,n)};N(ke,t=>{e(b).length===0?t(we):t(Se,!1)})}a(d),L(()=>{re=V(E,1,"btn btn-secondary text-sm svelte-1h8243g",null,re,{active:e(i)==="date"}),_(me,`Date ${e(i)==="date"?e(f)==="asc"?"↑":"↓":""}`),se=V(B,1,"btn btn-secondary text-sm svelte-1h8243g",null,se,{active:e(i)==="cost"}),_(ye,`Cost ${e(i)==="cost"?e(f)==="asc"?"↑":"↓":""}`),ne=V(F,1,"btn btn-secondary text-sm svelte-1h8243g",null,ne,{active:e(i)==="messages"}),_(be,`Messages ${e(i)==="messages"?e(f)==="asc"?"↑":"↓":""}`),_(he,`Showing ${e(b).length??""} of ${c.sessions.length??""} sessions`)}),Ge(T,()=>e(x),t=>k(x,t)),Je(h,()=>e(l),t=>k(l,t)),y(s,d),_e()}ve(["click"]);var nt=w('<div class="card p-6 border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20"><p class="text-red-800 dark:text-red-200"><strong>Error:</strong> </p> <button class="mt-4 btn btn-primary">Retry</button></div>'),ot=w('<div class="card p-6"><p class="text-gray-500 dark:text-gray-400 text-center">Loading sessions...</p></div>'),it=w('<div class="space-y-6"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Sessions</h1> <button class="btn btn-secondary" aria-label="Refresh sessions"> </button></div> <!></div>');function _t(s,c){ge(c,!0);let x=P(Re([])),l=P(!0),i=P(null);async function f(){try{k(l,!0),k(i,null);const d=await fetch("/api/sessions");if(!d.ok)throw new Error(`Failed to fetch sessions: ${d.statusText}`);const g=await d.json();k(x,g.sessions,!0)}catch(d){const g=d instanceof Error?d.message:String(d);k(i,g,!0),console.error("Error fetching sessions:",g)}finally{k(l,!1)}}function D(d){window.location.href=`/sessions/${d}`}Ve(()=>{});var m=it();Qe("1uha8ag",d=>{fe(()=>{Fe.title="Sessions - Claude Code Agent"})});var b=r(m),$=v(r(b),2);$.__click=()=>f();var W=r($,!0);a($),a(b);var Y=v(b,2);{var z=d=>{var g=nt(),S=r(g),T=v(r(S));a(S);var A=v(S,2);A.__click=()=>f(),a(g),L(()=>_(T,` ${e(i)??""}`)),y(d,g)},q=d=>{var g=Ue(),S=Oe(g);{var T=h=>{var M=ot();y(h,M)},A=h=>{st(h,{get sessions(){return e(x)},onSelect:D})};N(S,h=>{e(l)&&e(x).length===0?h(T):h(A,!1)},!0)}y(d,g)};N(Y,d=>{e(i)?d(z):d(q,!1)})}a(m),L(()=>{$.disabled=e(l),_(W,e(l)?"Loading...":"Refresh")}),y(s,m),_e()}ve(["click"]);export{_t as component};
